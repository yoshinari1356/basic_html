<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>event</title>
  <link rel="stylesheet" href="base.css">
</head>
<body>
  <section>
    <h1>event</h1>
    <p>イベントの発火を確認するためのページです。</p>
    <p>ソースとコンソールを見比べながら操作して挙動を確認するように使います</p>
    <p>イベント一覧<a href="https://html.spec.whatwg.org/multipage/indices.html#event-domcontentloaded">https://html.spec.whatwg.org/multipage/indices.html#event-domcontentloaded</a></p>
    <p>スプレッドシート<a href="https://docs.google.com/spreadsheets/d/1YMZj6_yy9RoCOx93c9xHhWvIH6h3XD4nnzJNbTBzWgw/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1YMZj6_yy9RoCOx93c9xHhWvIH6h3XD4nnzJNbTBzWgw/edit?usp=sharing</a></p>
  </section>
  <section>
    <h2>window/document load</h2>
    <p>コンソールを見てください</p>
    <pre><code id="code_script_load"></pre>
    </code>
    <script id="script_load">

      document.addEventListener("DOMContentLoaded", x => { console.log("document DOMContentLoaded")});
      document.addEventListener("readystatechange", x => { console.log("document readystatechange", document.readyState)});
      document.addEventListener("visibilitychange", x => { console.log("document visibilitychange")});

      window.addEventListener('blur', function(e) { console.log('window blur')});
      window.addEventListener('focus', function(e) { console.log('window focus')});
      window.addEventListener('load', function(e) { console.log('window load')});

      window.addEventListener("afterprint", function(e) { console.log("window afterprint")});
      window.addEventListener('beforeprint', function(e) { console.log('window beforeprint')});
      window.addEventListener('beforeunload', function(e) { console.log('window beforeunload')});
      window.addEventListener('hashchange', function(e) { console.log('window hashchange')});
      window.addEventListener('pagehide', function(e) { console.log('window pagehide')});
      window.addEventListener('pageshow', function(e) { console.log('window pageshow')});
      window.addEventListener('popstate', function(e) { console.log('window popstate')});
      window.addEventListener('storage', function(e) { console.log('window storage')});
      window.addEventListener('unload', function(e) { console.log('window unload')});
      window.addEventListener('contextmenu', function(e) { console.log('window contextmenu')});

    </script>
  </section>
  <section>
    <h2>element</h2>
    <div><input id="txt" type="text"></div>
    <div>
      <select id="slct">
          <option value="">未選択</option>
          <option value="dog">Dog</option>
          <option value="cat">Cat</option>
          <option value="hamster">Hamster</option>
          <option value="parrot">Parrot</option>
          <option value="spider">Spider</option>
          <option value="goldfish">Goldfish</option>
      </select>
    </div>
    <div><img id="img" src="./images/icon_128_128.png"></div>
    <pre><code id="code_script_input"></pre>
    </code>
    <script id="script_input">
      const txt_elm = document.getElementById("txt")
      txt_elm.addEventListener('blur', function(e) { console.log('txt_elm blur')});
      txt_elm.addEventListener('focus', function(e) { console.log('txt_elm focus')});
      txt_elm.addEventListener('change', function(e) { console.log('txt_elm change')});
      txt_elm.addEventListener('input', function(e) { console.log('txt_elm input')});
      txt_elm.addEventListener('invalid', function(e) { console.log('txt_elm invalid')});
      txt_elm.addEventListener('select', function(e) { console.log('txt_elm select')});
      txt_elm.addEventListener('load', function(e) { console.log('txt_elm load', txt_elm)});
      txt_elm.addEventListener('contextmenu', function(e) { console.log('txt_elm contextmenu')});
      txt_elm.addEventListener('copy', function(e) { console.log('txt_elm copy')});
      txt_elm.addEventListener('cut', function(e) { console.log('txt_elm cut')});
      txt_elm.addEventListener('paste', function(e) { console.log('txt_elm paste')});
      txt_elm.addEventListener('cancel', function(e) { console.log('txt_elm cancel')});

      const slct_elm = document.getElementById("slct")
      slct_elm.addEventListener('click', function(e) { console.log('slct_elm click')});
      slct_elm.addEventListener('blur', function(e) { console.log('slct_elm blur')});
      slct_elm.addEventListener('focus', function(e) { console.log('slct_elm focus')});
      slct_elm.addEventListener('change', function(e) { console.log('slct_elm change')});
      slct_elm.addEventListener('input', function(e) { console.log('slct_elm input')});
      slct_elm.addEventListener('invalid', function(e) { console.log('slct_elm invalid')});
      slct_elm.addEventListener('select', function(e) { console.log('slct_elm select')});
      slct_elm.addEventListener('load', function(e) { console.log('slct_elm load', slct_elm)});
      slct_elm.addEventListener('contextmenu', function(e) { console.log('slct_elm contextmenu')});
      slct_elm.addEventListener('cancel', function(e) { console.log('slct_elm cancel')});

      const img_elm = document.getElementById("img")
      img_elm.addEventListener('load', function(e) { console.log('img_elm load', img_elm)});
      img_elm.addEventListener('contextmenu', function(e) { console.log('img_elm contextmenu')});
    </script>
  </section>
  <section>
    <h2>dialog</h2>
    <div>
      <!-- Simple pop-up dialog box containing a form -->
      <dialog id="favDialog">
        <form method="dialog">
          <p><label>Favorite animal:
            <select>
              <option></option>
              <option>Brine shrimp</option>
              <option>Red panda</option>
              <option>Spider monkey</option>
            </select>
          </label></p>
          <menu>
            <button value="cancel">Cancel</button>
            <button id="dialogConfirmBtn" value="default">Confirm</button>
          </menu>
        </form>
      </dialog>

      <button id="updateDetails">Update details</button>
      <pre><code id="code_script_dialog"></code></pre>

    </div>
    <script id="script_dialog">
      {
        // dialog
        var updateButton = document.getElementById('updateDetails');
        var favDialog = document.getElementById('favDialog');
        var selectElm = document.querySelector('#favDialog select');
        var confirmBtn = document.getElementById('dialogConfirmBtn');

        // "Update details" button opens the <dialog> modally
        updateButton.addEventListener('click', function onOpen() {
          console.log('dialog updateButton click', updateButton)
          if (typeof favDialog.showModal === "function") {
            favDialog.showModal();
          } else {
            alert("The <dialog> API is not supported by this browser");
          }
        });
        // "Favorite animal" input sets the value of the submit button
        selectElm.addEventListener('change', function onSelect(e) {
          console.log('dialog selectElm change', selectElm)
          confirmBtn.value = selectElm.value;
        });
        // "Confirm" button of form triggers "close" on dialog because of [method="dialog"]
        favDialog.addEventListener('close', function onClose() {
          console.log('dialog favDialog close', favDialog)
        });
      }
    </script>
  </section>
  <section class="progress window">
    <h2>details</h2>
    <details id="detail">
     <summary>Copying... <progress max="375505392" value="97543282"></progress> 25%</summary>
     <dl>
      <dt>Transfer rate:</dt> <dd>452KB/s</dd>
      <dt>Local filename:</dt> <dd>/home/rpausch/raycd.m4v</dd>
      <dt>Remote filename:</dt> <dd>/var/www/lectures/raycd.m4v</dd>
      <dt>Duration:</dt> <dd>01:16:27</dd>
      <dt>Color profile:</dt> <dd>SD (6-1-6)</dd>
      <dt>Dimensions:</dt> <dd>320×240</dd>
     </dl>
    </details>
    <pre><code id="code_script_datail"></code></pre>
    <script id="script_datail">
      const detail_elm = document.getElementById("detail")
      detail_elm.addEventListener('toggle', function(e) { console.log('detail_elm toggle', detail_elm)});
    </script>
   </section>
   <section id="drag">
    <div class="dropzone">
      <div id="draggable" draggable="true" ondragstart="event.dataTransfer.setData('text/plain',null)">
        This div is draggable
      </div>
    </div>
    <div class="dropzone"></div>
    <div class="dropzone"></div>
    <div class="dropzone"></div>
    <style>
      #draggable {
        width: 200px;
        height: 20px;
        text-align: center;
        background: white;
      }

      .dropzone {
        width: 200px;
        height: 20px;
        background: blueviolet;
        margin-bottom: 10px;
        padding: 10px;
      }
    </style>
    <script>
      var dragged;
      /* events fired on the draggable target */
      document.addEventListener("drag", function(e) {
        console.log("drag", e.offsetX, e.pageX, e.screenX, e.layerX)
      }, false);

      document.addEventListener("dragstart", function(event) {
        console.log("dragstart")
        // store a ref. on the dragged elem
        dragged = event.target;
        // make it half transparent
        event.target.style.opacity = .5;
      }, false);

      document.addEventListener("dragend", function(event) {
        console.log("dragend")
        // reset the transparency
        event.target.style.opacity = "";
      }, false);

      /* events fired on the drop targets */
      document.addEventListener("dragover", function(event) {
        console.log("dragover")
        // prevent default to allow drop
        event.preventDefault();
      }, false);

      document.addEventListener("dragenter", function(event) {
        console.log("dragenter")
        // highlight potential drop target when the draggable element enters it
        if (event.target.className == "dropzone") {
          event.target.style.background = "purple";
        }

      }, false);

      document.addEventListener("dragleave", function(event) {
        console.log("dragleave")
        // reset background of potential drop target when the draggable element leaves it
        if (event.target.className == "dropzone") {
          event.target.style.background = "";
        }

      }, false);

      document.addEventListener("drop", function(event) {
        // prevent default action (open as link for some elements)
        event.preventDefault();
        // move dragged elem to the selected drop target
        if (event.target.className == "dropzone") {
          event.target.style.background = "";
          dragged.parentNode.removeChild( dragged );
          event.target.appendChild( dragged );
        }
      }, false);

    </script>
   </section>
  <script>
    // 各スクリプトタグをcodeタグにコピーして表示する
    Array.prototype.forEach.call(document.scripts,elm => {
      if(elm.id != '') {
        code_elm = document.getElementById("code_" + elm.id)
        if(code_elm) {
          code_elm.innerText = elm.innerText
        }
      }
    })
  </script>
  <style>
    section {
      max-width: 500px;
      margin: auto;
    }
    .value {
      text-align: end;
    }
  </style>
</body>
</html>